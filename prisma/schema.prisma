generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Usuários do sistema
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String
  password  String
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  simulations       Simulation[]
  sharedSimulations SimulationShare[]

  @@map("users")
}

// Simulações salvas
model Simulation {
  id        String   @id @default(cuid())
  userId    String
  name      String
  data      Json // Todas as taxas e configurações
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user   User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  shares SimulationShare[]

  @@index([userId])
  @@map("simulations")
}

// Compartilhamento de simulações
model SimulationShare {
  id           String   @id @default(cuid())
  simulationId String
  sharedWithId String
  createdAt    DateTime @default(now())

  simulation Simulation @relation(fields: [simulationId], references: [id], onDelete: Cascade)
  sharedWith User       @relation(fields: [sharedWithId], references: [id], onDelete: Cascade)

  @@unique([simulationId, sharedWithId])
  @@map("simulation_shares")
}
